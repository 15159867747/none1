<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie6 page_index_" lang="zh-cn"><![endif]-->
<!--[if IE 7 ]><html class="ie7 page_index_" lang="zh-cn"><![endif]-->
<!--[if IE 8 ]><html class="ie8 page_index_" lang="zh-cn"><![endif]-->
<!--[if IE 9 ]><html class="ie9 page_index_" lang="zh-cn"><![endif]-->
<!--[if (gt IE 9)|!(IE) ]><html page_index_ lang="zh-cn"><![endif]-->
<html class="page_index_ " data-fs="">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>艺起看-综艺节目一起看</title>

    <!--[if lt IE 7 ]>
    <![endif]-->


<!--    <link rel="stylesheet" type="text/css" href="css/base.css"/>
    <link rel="stylesheet" type="text/css" href="css/Torr.css"/>

    <script  charset="utf-8" src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/core.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/v8.js"></script> -->
		

	<script src="laydate/laydate.js"></script> <!-- 改成你的路径 -->
	
	<link rel="stylesheet"   href="css/base.css" />
	
	<script  charset="utf-8" src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script>
	
	<script type="text/javascript" src="js/sweetalert.min.js"></script>
    <script type="text/javascript" src="js/card.js"></script>
	<script type="text/javascript" src="js/sweetalert-dev.js"></script>
	<link rel="stylesheet" type="text/css" href="css/sweetalert.css"/>
</head>
<body>











<div class="head-mod z-app-head fix " id="nav-container" style="height:98px;">
    <div class="hd-content z-app-head fixed fix" id="nav-container-main" style="">
        <div class="mod-wrap hd-wrap">
            <div class="hd-left fix">
                <div class="hd-logo">
                    <h1 class="logo"><a href="/index.html" title="艺起看" hidefocus><img style="overflow: hidden;" src="img/艺起看3.png"/></a></h1>
                    <div class="hd-ad">
                        <div class="ad-wrap" data-deliver="ws_index__logo">
                        </div>
                    </div>
                    <div class="hd-line">
                        &nbsp;
                    </div>

                    <div class="hd-menu hd-ret" id="subMenuLayout" data-hover-wrap="show-panel">
                        <!--<a href="" class="tit-inner head-btn fix tool-comboxlike" data-target=".hd-menu-wrap" data-mouse="mouseover" data-hover-ele="1">-->
                        <b class="lump hd-nav-ico"></b>
                        <b class="hd-menu-ico"></b>
                        <!--<b class="tit">分类</b>-->
                        <em class="icon"></em>
                        </a>

                    </div>
              
                    <div class="" style="float: left;margin-top: 15px;text-align: center;margin-left: 100px;">
                        <form onsubmit="" name="msearch" id="msearch" action="" method="get">
                            <div style="margin-top: -8px">
                                <input style="width: 280px;height: 30px;margin-left:0;border:1px solid #ddd;border-right: none;padding-left: 10px;" block="soframe_1_0" type="text" class="" name="word"  id="vue" autocomplete="off" maxlength="30" lang="zh-cn"/>
                                <a style="font-size: 21px;line-height: 40px; background-color: orange; " target="_blank " class="seedplay play-btn-b" id="sousuo" >搜索</a>
                            </div>

                        </form>
                    </div>

                </div>

            </div>

            <div class="hd-right hd-menu-common fix">
                <div class="hd-user">
                    <div class="login-wrap">
                        <div class="login-btn-wrap" id="loginLayout">
                            <i class="login-bg"></i>
                            <div class="btns">
                                <a id="login-btn" href="/login.html">登录</a>
                                <a id="userinform" href="javascript:getUserInform()">个人中心</a>
                                <i class="line"></i>
                                <a id="register-btn" href="/register.html" >注册</a>
                                <a id="exit" href="javascript:exitlogin()" >退出</a>
                            </div>
                        </div>

                    </div>





                </div>
            </div>
            <div class="page-progress" id="page-progress">
            </div>
        </div>
        <div class="hd-content-sub z-app-footer fixed" id="nav-container-sub">
            <div class="hd-content-sub-con fix">
                <div class="mod-wrap sub-wrap">
                    <div class="nav">
                        <div class="prev">
                            <a class="item large current" href="/index.html">首页</a>
                            <a class="item large new" href="/VarietyType.html?area=内地&type=全部类型">内地<i></i></a>
                            <a class="item large" href="/VarietyType.html?area=中国台湾&type=全部类型">中国台湾</a>
                            <a class="item large" href="/VarietyType.html?area=中国香港&type=全部类型">中国香港</a>
                            <i class="sep"></i>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=搞笑">搞笑</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=情感">情感</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=真人秀">真人秀</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=亲子">亲子</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=娱乐">娱乐</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=相亲">相亲</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=美食">美食</a>
                        </div>
                    </div>
                    <!--<a href="javascript:void(null);" class="nav-toggle nav-opacity0"><span>更多</span><i></i></a>-->
                    <!--<div class="nav-ad">-->
                        <!--<div class="ad-wrap" data-deliver="ws_nav_guide">-->
                        <!--</div>-->
                    <!--</div>-->
                  
                </div>
            </div>
        </div>
    </div>



<div class="personal set-wrap" style="margin-top: 90px;">
	<div class="left-navigate">
    <div class="nav-con">
        <div class="level1">
            <p class="homepage"><a href="/index.html">首页</a></p>
            <p class="account-setting current"><a href="javascript:getUserInform()">个人资料</a></p>
            <p class="account-setting current"><a href="/myRatings.html">我的节目评星</a></p>
            <p class="account-setting current"><a href="/mycomment.html">我的节目评论</a></p>
            <p class="account-setting current"><a href="/secret.html">修改密码</a></p>
        </div>
  
    </div>
</div>
    <div class="setting-title">个人资料</div>
    <form method="post"  class="fix account-info" id="FormUserInform">
    <div class="prset-item fix">
        <dl class="fix">
            <dt><em>*</em>昵称：</dt>
            <dd>
                <input type="text" class="t" id="name" name="nickname" >
                <label class="show-err" id="for-nickname"></label>
            </dd>
        </dl>
        <dl class="fix">
            <dt><em>*</em>性别：</dt>
            <dd>
                <input type="radio" name="sex" id="sexMale" class="b" value="m"  ><label class="sex" for="sexMale">男</label>
                <input type="radio" name="sex" id="sexFemale" class="b s-female" value="f" ><label class="sex" for="sexFemale">女</label>
                <label class="show-err" id="for-sexFemale"></label>
            </dd>
        </dl>
	
        <dl class="fix">
            <dt><em>*</em>生日：</dt>
            <dd>
				
				<input type="text" id="test1" class="t" readonly="readonly">
        </dl>
		<p class="">
			<input type="button" class="login_submit" style=" margin-top: 12px; width:245px;height:40px;border: 1px solid #BBBBBB;color: #fff;background-color: #2B8D05;font-size: 20px;font-family: '黑体';font-weight: bold;margin-left: 166px;" value="确认修改" onclick="updateUserinform()">
		
	</p></div>
    </form>
</div>






    <div class="page-wrap" style="margin-top: 90px;">

    </div>



    <!-- <link rel="stylesheet" href="card.less"/>
    <script type="text/javascript" src="js/card.js"></script> -->
<!-- 底部样式    -->
<div class="footer fix" id="footer">
	<div class="mod-wrap">
		<div class="foot-wrap">
			<div class="foot-link fix" >
				<h2 align="center">该网站用于毕业设计学习，如有侵权请联系QQ：1049084904进行删除</h2>
			</div>
			
		
		</div>
	</div>
</div>
	<!-- ================================================== -->

    <div class="gototop fixed" id="gototopwrap">
        <div class="ad-game-tip" data-deliver="ws_all_game"></div>
        <a class="question-btn" href=""></a>
        <a class="totop-btn" id="totopBtn" href="javascript:void(window.scroll(0,0));" hidefocus></a>
    </div>

    <div class="ad-client-tip" data-deliver="ws_all_bottom"></div>

    <script type="text/javascript" charset="utf-8" src="js/widget.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/tool.js"></script>


    <script type="text/javascript">

        $("#sousuo").click(function(){
            $(this).attr("href","/searchVariety.html?word="+$("#vue").val());
        })


        //执行一个laydate实例
        laydate.render({
            elem: '#test1' //指定元素
        });


     //从url上取值填充表单
        function setvalues() {
            $("#name").val(getQueryVariable("name"));


            if(getQueryVariable("sex")=="m")
            {
                $("#sexMale").attr("checked", true);
            }
            if (getQueryVariable("sex")=="f")
            {
                $("#sexFemale").attr("checked", true);
            }
            console.log(dateFormat_2(getQueryVariable("birthday")))
            $("#test1").val(dateFormat_2(getQueryVariable("birthday")));

        }


        //s刷新页面
        function refresh(){
            var token=getCookie("token");
            if (token!=null){
                $("#login-btn").css("display","none");
                $("#register-btn").css("display","none");
                setvalues();
                // getUserInform()

                // alert(getQueryVariable("name"));
            }
            if(token==null||token=="")
            {
                $("#userinform").css("display","none");
                $("#exit").css("display","none");
                window.location.href = '/index.html';

            }
        }
        //修改个人信息
        function updateUserinform() {
		    // console.log($("#id").val())
                var id =getCookie("userid");
                var name=$("#name").val();
                var sex=$("input:radio:checked").val();
                var date=dateTolong($("#test1").val());
                console.log(name,sex,date);
		    if (name==null||name=="")
			{
		        swal("亲，昵称不能为空哦");
		        // swal("Good!", "弹出了一个操作成功的提示框", "success");
			}
			else if(name.length>20)
            {
                swal("名字好像有点长哦，要不你取短点试试？");
            }
			else {
		        $.ajax({
		            //几个参数需要注意一下
		            type: "post",//方法类型
		            dataType: "json",//预期服务器返回的数据类型
		            url: "/API/index/updateUserInform" ,//url
		            data: {
                        id:id,
                        name:name,
                        sex:sex,
                        birthday:date
                    },
		            success: function (result) {
		                console.log(result);//打印服务端返回的数据(调试用)
		                if (result.code == 1) {
		                     // swal("!", "", "success");
		                    // console.log(result.data.token,result.data.name,result.data.id);
		                    // window.location.href = '/index.html';
                            swal("修改成功!", "", "success");

                            setTimeout("getUserInform()", 2000 );

		                }
		                if(result.code==-1){
		                    swal("修改失败啦，要不您再试试？", "", "error");
						}

		                ;
		            },
		            error : function(e) {
                        swal("身份验证失败请重新登录", "", "error");
                        exitTologin();
		            }
		        });
			}		
		}

        //跳转到个人中心
        function getUserInform() {
            // console.log($("#id").val())
            var token=getCookie("token");
            var userid=getCookie("userid");
            if (token==null||token=="")
            {
                window.location.href = '/login.html';
                // swal("Good!", "弹出了一个操作成功的提示框", "success");
            }
            else {

                $.ajax({
                    //几个参数需要注意一下
                    type: "post",//方法类型
                    dataType: "json",//预期服务器返回的数据类型
                    url: "/API/index/userInform" ,//url
                    data: {
                        userid:userid
                    },
                    success: function (result) {
                        console.log(result);//打印服务端返回的数据(调试用)
                        if (result.code == 1) {
                            // swal("登录成功!", "", "success");


                            window.location.href = '/userinform.html?name='+result.data.name+'&sex='+result.data.sex+'&birthday='+result.data.birthday;
                        }
                        if(result.code==-1){
                            swal("系统异常!", "", "error");

                        }},
                    error : function(e) {
                        swal("身份验证失败请重新登录", "", "error");
                        exitTologin();
                    }
                });
            }



        }

        window.refresh();




		

    </script>

	
	


</body>
</html>


