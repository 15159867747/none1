<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie6 page_index_" lang="zh-cn"><![endif]-->
<!--[if IE 7 ]><html class="ie7 page_index_" lang="zh-cn"><![endif]-->
<!--[if IE 8 ]><html class="ie8 page_index_" lang="zh-cn"><![endif]-->
<!--[if IE 9 ]><html class="ie9 page_index_" lang="zh-cn"><![endif]-->
<!--[if (gt IE 9)|!(IE) ]><html page_index_ lang="zh-cn"><![endif]-->
<html class="page_index_ " data-fs="">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>艺起看-综艺节目一起看</title>

    <!--[if lt IE 7 ]>
    <![endif]-->


    <!--<link rel="stylesheet" type="text/css" href="css/base.css"/>-->
    <!--<link rel="stylesheet" type="text/css" href="css/Torr.css"/>-->

    <!--<script  charset="utf-8" src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script>-->
    <!--<script type="text/javascript" charset="utf-8" src="js/core.js"></script>-->
    <!--<script type="text/javascript" charset="utf-8" src="js/v8.js"></script> -->


    <script src="http://www.jq22.com/jquery/jquery-1.10.2.js"></script>


    <script src="laydate/laydate.js"></script> <!-- 改成你的路径 -->
    <link rel="stylesheet"   href="css/base.css" />

    <link rel="stylesheet"   href="css/recommend.css" />

    <!--<script  charset="utf-8" src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script>-->
    <script type="text/javascript" src="js/jquery.comment.js" ></script>

    <script type="text/javascript" src="js/sweetalert.min.js"></script>
    <script type="text/javascript" src="js/card.js"></script>
    <script type="text/javascript" src="js/sweetalert-dev.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
    <link rel="stylesheet" type="text/css" href="css/sweetalert.css"/>
    <link type="text/css" href="css/style.css" rel="stylesheet" />
    <!--<link rel="stylesheet" type="text/css" href="css/bootstrap.css">-->
    <style>
        .container{
            width: 1000px;
        }
        .commentbox{
            width: 900px;
            margin: 20px auto;
        }
        .mytextarea {
            width: 100%;
            overflow: auto;
            word-break: break-all;
            height: 100px;
            color: #000;
            font-size: 1em;
            resize: none;
        }
        .comment-list{
            width: 900px;
            margin: 20px auto;
            clear: both;
            padding-top: 20px;
        }
        .comment-list .comment-info{
            position: relative;
            margin-bottom: 20px;
            margin-bottom: 20px;
            border-bottom: 1px solid #ccc;
        }
        .comment-list .comment-info header{
            width: 10%;
            position: absolute;
        }
        .comment-list .comment-info header img{
            width: 100%;
            border-radius: 50%;
            padding: 5px;
        }
        .comment-list .comment-info .comment-right{
            padding:5px 0px 5px 11%;
        }
        .comment-list .comment-info .comment-right h3{
            margin: 5px 0px;
        }
        .comment-list .comment-info .comment-right .comment-content-header{
            height: 25px;
        }
        .comment-list .comment-info .comment-right .comment-content-header span,.comment-list .comment-info .comment-right .comment-content-footer span{
            padding-right: 2em;
            color: #aaa;
        }
        .comment-list .comment-info .comment-right .comment-content-header span,.comment-list .comment-info .comment-right .comment-content-footer span.reply-btn,.send,.reply-list-btn{
            cursor: pointer;
        }
        .comment-list .comment-info .comment-right .reply-list {
            border-left: 3px solid #ccc;
            padding-left: 7px;
        }
        .comment-list .comment-info .comment-right .reply-list .reply{
            border-bottom: 1px dashed #ccc;
        }
        .comment-list .comment-info .comment-right .reply-list .reply div span{
            padding-left: 10px;
        }
        .comment-list .comment-info .comment-right .reply-list .reply p span{
            padding-right: 2em;
            color: #aaa;
        }





    </style>


    <style>
        /* 外面盒子样式---自己定义 */
        .page_div{margin:20px 10px 20px 0;color:#666}
        /* 页数按钮样式 */
        .page_div button{display:inline-block;min-width:30px;height:28px;cursor:pointer;color:#666;font-size:13px;line-height:28px;background-color:#f9f9f9;border:1px solid #dce0e0;text-align:center;margin:0 4px;-webkit-appearance: none;-moz-appearance: none;appearance: none;}
        #firstPage,#lastPage,#nextPage,#prePage{width:50px;color:#0073A9;border:1px solid #0073A9}
        #nextPage,#prePage{width:70px}
        .page_div .current{background-color:#0073A9;border-color:#0073A9;color:#FFF}
        /* 页面数量 */
        .totalPages{margin:0 10px}
        .totalPages span,.totalSize span{color:#0073A9;margin:0 5px}
        /*button禁用*/
        .page_div button:disabled{opacity:.5;cursor:no-drop}

    </style>
</head>









<div class="head-mod z-app-head fix " id="nav-container" style="height:98px;">
    <div class="hd-content z-app-head fixed fix" id="nav-container-main" style="">
        <div class="mod-wrap hd-wrap">
            <div class="hd-left fix">
                <div class="hd-logo">
                    <h1 class="logo"><a href="/index.html" title="艺起看" hidefocus><img style="overflow: hidden;" src="img/艺起看3.png"/></a></h1>
                    <div class="hd-ad">
                        <div class="ad-wrap" data-deliver="ws_index__logo">
                        </div>
                    </div>
                    <div class="hd-line">
                        &nbsp;
                    </div>

                    <div class="hd-menu hd-ret" id="subMenuLayout" data-hover-wrap="show-panel">
                        <!--<a href="" class="tit-inner head-btn fix tool-comboxlike" data-target=".hd-menu-wrap" data-mouse="mouseover" data-hover-ele="1">-->

                    </div>

                    <div class="" style="float: left;margin-top: 15px;text-align: center;margin-left: 100px;">
                        <form onsubmit="" name="msearch" id="msearch" action="" method="get">
                            <div style="margin-top: -8px">
                                <input style="width: 280px;height: 30px;margin-left:0;border:1px solid #ddd;border-right: none;padding-left: 10px;" block="soframe_1_0" type="text" class="" name="word"  id="vue" autocomplete="off" maxlength="30" lang="zh-cn"/>
                                <a style="font-size: 21px;line-height: 40px; background-color: orange; " target="_blank " class="seedplay play-btn-b" id="sousuo" >搜索</a>
                            </div>

                        </form>
                    </div>

                </div>

            </div>

            <div class="hd-right hd-menu-common fix">
                <div class="hd-user">
                    <div class="login-wrap">
                        <div class="login-btn-wrap" id="loginLayout">
                            <i class="login-bg"></i>
                            <div class="btns">
                                <a id="login-btn" href="/login.html">登录</a>
                                <a id="userinform" href="javascript:getUserInform()">个人中心</a>
                                <i class="line"></i>
                                <a id="register-btn" href="/register.html" >注册</a>
                                <a id="exit" href="javascript:exitlogin()" >退出</a>
                            </div>
                        </div>

                    </div>





                </div>
            </div>
            <div class="page-progress" id="page-progress">
            </div>
        </div>
        <div class="hd-content-sub z-app-footer fixed" id="nav-container-sub">
            <div class="hd-content-sub-con fix">
                <div class="mod-wrap sub-wrap">
                    <div class="nav">
                        <div class="prev">
                            <a class="item large current" href="/index.html">首页</a>
                            <a class="item large new" href="/VarietyType.html?area=内地&type=全部类型">内地<i></i></a>
                            <a class="item large" href="/VarietyType.html?area=中国台湾&type=全部类型">中国台湾</a>
                            <a class="item large" href="/VarietyType.html?area=中国香港&type=全部类型">中国香港</a>
                            <i class="sep"></i>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=搞笑">搞笑</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=情感">情感</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=真人秀">真人秀</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=亲子">亲子</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=娱乐">娱乐</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=相亲">相亲</a>
                            <a class="item" href="/VarietyType.html?area=全部地区&type=美食">美食</a>


                        </div>
                    </div>

                    <div class="nav-ad">
                        <div class="ad-wrap" data-deliver="ws_nav_guide">
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>



    <div class="personal set-wrap" style="height:auto;margin-top: 0px;margin-left: -100px;padding-bottom: 200px">
        <div style="float: right;width:20%;height:600px;position:absolute;background-color: transparent;right: 200px;margin-top: 100px">
            <!--&lt;!&ndash;transparent 透明&ndash;&gt;-->
            <!--<div style="font-size: 40px " >猜你喜欢</div>-->
            <!--<div>&nbsp;</div>-->
            <!--<div>-->
                <!--<div class="mod-frag">-->
                    <!--<ul class="img">-->
                        <!--<li><a href=""><img src="http://0img.hitv.com/preview/internettv/sp_images/ott/2016/zongyi/117447/20160506140629837-new.jpg_220x123.jpg"  alt="中国" /></a></li>-->
                        <!--&lt;!&ndash;<div class="info">&ndash;&gt;-->
                        <!--&lt;!&ndash;<h3 class="tit"><a href=""  title="探索在路上（十）：重庆涪陵白鹤梁，世界首座水下博物馆">天哪天</a>&ndash;&gt;-->
                        <!--&lt;!&ndash;</h3>&ndash;&gt;-->
                        <!--&lt;!&ndash;</div>&ndash;&gt;-->
                        <!--<li><a href=""><img src="http://0img.hitv.com/preview/internettv/sp_images/ott/2016/zongyi/117447/20160506140629837-new.jpg_220x123.jpg"  alt="中国" /></a></li>-->
                        <!--<li><a href=""><img src="http://0img.hitv.com/preview/internettv/sp_images/ott/2016/zongyi/117447/20160506140629837-new.jpg_220x123.jpg"  alt="中国" /></a></li>-->
                        <!--<li><a href=""><img src="http://0img.hitv.com/preview/internettv/sp_images/ott/2016/zongyi/117447/20160506140629837-new.jpg_220x123.jpg"  alt="中国" /></a></li>-->
                        <!--<li><a href=""><img src="http://0img.hitv.com/preview/internettv/sp_images/ott/2016/zongyi/117447/20160506140629837-new.jpg_220x123.jpg"  alt="中国" /></a></li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</div>-->
            <div class="media-tab media-tab-pic-v">
                <div class="tab-inner">
                    <ul class="fix">
                        <li class="fix-width current"><span class="sub">相关影视</span><span class="tit-line"><em class="arr"></em></span></li>
                    </ul>
                </div>
                <div class="tab-content">
                    <div class="tab-content-item current">
                        <div class="m-vd-list guess-group">
                            <div class="mod-wrap-in" id="media-rel-data">


                                <div class="mod-vd-group-i fix" id="VarietySame">

                                </div>













                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <div class="subject-head fix z-2">
            <div class="main crumbsline" style="padding-top: 100px;margin: 30px 0 15px 0;font-size: 14px">

            </div>
            <div class="pic" style="float: left;margin-right: 20px">
                <a class="seedplay play-btn-a"  target="_blank" href="">
                    <img src="" alt="" class="" id="img1" style="width: 200px;height: 300px">
                </a>

            </div>
            <div class="info" style="float: left;">
                <h3 class="tit">
                    <a style="font-size: 30px;line-height: 40px"  target="_blank" class="seedplay play-btn-b" href="" id="name"></a>

                    <!--<span class="update-info" style="font-size: 14px;">全集</span>-->
                </h3>

                <div class="rating fix"  style="margin: 15px 0 10px">
                    <div class="karma" style="float: left;font-size: 20px;color: orange"><i>我来评分</i></div>
                    <!--<div class="rating-title" style="float: left;margin: 0 20px">我来评分：</div>-->

                    <div class="xzw_starSys" style="float: left;margin: 0 15px;padding: 0">
                        <div class="xzw_starBox">
                            <ul class="star stars">
                                <!--<a id="userinform" href="javascript:getUserInform()" >个人中心</a>-->
                                <li><a href="javascript:insertRatings(1)" id="r1" title="1" class="one-star">1</a></li>
                                <li><a href="javascript:insertRatings(2)" title="2" class="two-stars">2</a></li>
                                <li><a href="javascript:insertRatings(3)" title="3" class="three-stars">3</a></li>
                                <li><a href="javascript:insertRatings(4)" title="4" class="four-stars">4</a></li>
                                <li><a href="javascript:insertRatings(5)" title="5" class="five-stars" display="block">5</a></li>
                            </ul>
                            <div class="current-rating showb" id="showb" style="width: 0"></div>
                        </div>

                    </div>



                    <div class="rating-tip" id="rating-tip"></div>
                </div>
                <div class="desc" style="margin: 10px 0;font-size: 14px">
                    <i>更新时间：</i>
                    <span id="updatetime"> </span>
                </div>
                <div class="desc" style="margin: 10px 0;font-size: 14px" id="areadiv">
                    <i>地区：</i>

                </div>
                <div class="desc" style="margin: 10px 0;font-size: 14px" id="type">
                    <i>类型：</i>
                    <a href=""  target="_blank" > </a>                                                             </div>

                <div class="desc" style="margin: 10px 0;font-size: 14px" id="fromtvdiv">
                    <i>播出频道：</i>
                </div>
                <!--<a href=""  target="_blank" id= "fromtv"> </a>  /

                                                                                                                                     <-->
                <div id="btngroup" class="btngroup " style="margin: 30px 0 0 0">
                    <div style="position:relative;" class="fix"><a href="/vplay/g-323813/?from=subject" class="pbtn tryplay-btn"></a>
                        <div class="op-group fix">
                            <button style="float: left;width: 120px;height: 35px;background-color: #5FB878;cursor: pointer;color: #fff;border: none;border-radius: 5px" onclick="showTV()" id="show">立即播放</button>

                            <div class="inner fix">

                                <div class="clear"></div>
                                <i></i>

                            </div>
                        </div>
                        <div class="mobilebtn-wrap pop-wrap z-act-pop" style="display: none;">

                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!--横线-->


        <div>
            <div style="width: 60%;border-top: 1px solid #ddd;margin-top: 164px;"></div>
        <div style="width: 60%;">

            <div style="font-size: 20px;margin: 10px 0"></div>
            <p style="text-indent: 2em;font-size: 16px;line-height: 30px" id="content-pane"></p>
        </div>
        <div style="width: 60%;border-top: 1px solid #ddd;margin: 30px 0"></div>
        <div style="width: 60%;">
            <div style="font-size: 20px;margin: 10px 0">评论：</div>
            <div class="container" style="padding-left: 0">
                <div class="commentbox">
                    <textarea maxlength="300" cols="80" rows="50" placeholder="来说几句吧......" class="mytextarea" id="content"></textarea>
                    <!--<div class="btn btn-info pull-right" id="comment">评论</div>-->
                    <button style="float: right;width: 120px;height: 35px;background-color:gainsboro;cursor: pointer;color: black;border: none;border-radius: 5px " id="comment">评论</button>

                </div>
                <div class="comment-list" id="mydiv">



                </div>
            </div>

        </div>
    </div>


        <!--<div class="zxf_pagediv"></div>-->


        <!--分页-->
        <div id="page" class="page_div" style="position: absolute;left: 20%;buttom: 0;z-index:999999;margin: 30px 0 50px"></div>


    </div>
    <!-- 底部样式    -->
    <div class="footer fix" id="footer">
        <div class="mod-wrap">
            <div class="foot-wrap">
                <div class="foot-link fix" >
                    <h2 align="center">该网站用于毕业设计学习，如有侵权请联系QQ：1049084904进行删除</h2>
                </div>


            </div>
        </div>
    </div>
</div>
</div>



<
<!-- ================================================== -->

<!--<div class="gototop fixed" id="gototopwrap">-->
<!--<div class="ad-game-tip" data-deliver="ws_all_game"></div>-->
<!--<a class="question-btn" href=""></a>-->
<!--<a class="totop-btn" id="totopBtn" href="javascript:void(window.scroll(0,0));" hidefocus></a>-->
<!--</div>-->

<!--<div class="ad-client-tip" data-deliver="ws_all_bottom"></div>-->

<!--<script type="text/javascript" charset="utf-8" src="js/widget.js"></script>-->
<!--<script type="text/javascript" charset="utf-8" src="js/tool.js"></script>-->
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/pageMe.js"></script>
<script type="text/javascript"></script>

<script type="text/javascript">

    // 显示相关节目
function VarietySame(type,name) {

    $.ajax({
        //几个参数需要注意一下
        type: "post",//方法类型
        dataType: "json",//预期服务器返回的数据类型
        async : false,
        url: "/YqLook/varietySame" ,//url
        data: {
            type:type,
            name:name
        },
        success: function (result) {
            console.log(result);//打印服务端返回的数据(调试用)
            if(result.code==1){

                var el="";
                for (var n = 0; n < result.data.pageSize; n++)
                {

                    //   console.log(result.data.list[n].name)

                    el =el+ "  <div class=\"mod-vd-i fix\">\n" +
                        "                                        <div class=\"pic\">\n" +
                        "                                            <a href=\"/VarietyDetails.html?name="+ result.data.list[n].name+ "&varietyId="+result.data.list[n].id +  "\" data-gtype=\"tv\" block=\"guess_1_media\" data-id=\"316099\"  title="+ result.data.list[n].name+"    target=\"_blank\">\n" +
                        "                                                <img src="+result.data.list[n].picurl+">\n" +
                        "                                                <span class=\"mask\"><i class=\"play-btn\"></i></span>\n" +
                        "                                            </a>\n" +
                        "                                        </div>\n" +
                        "                                        <div class=\"info\">\n" +
                        "                                            <h3 class=\"tit\"><a href=\"/VarietyDetails.html?name="+ result.data.list[n].name+ "&varietyId="+result.data.list[n].id +  "\"   title="+ result.data.list[n].name+"   block=\"guess_1_media\" target=\"_blank\">"+result.data.list[n].name+"</a></h3>\n" +
                        "                                            <p>"+result.data.list[n].name+"</p>\n" +
                        "                                        </div>\n" +
                        "                                    </div>";
                }

                var div = document.getElementById("VarietySame");
                div.innerHTML=el;
            }
            else{
                swal("哎呀出错了", "", "error");



            }
        },
        error : function(e) {
            // alert("异常！");
            // window.location.href = '/404.html';
            // window.location.href = '/404.html';
            swal("哎呀出错了，要不你稍后再试试？", "", "error");


            // check= "-1";
        }

    });

}



    var showtvurl="";

    /* 判断节目id是否存在*/

    function checkVarietyId()
    {  var name=decodeURIComponent(getQueryVariable("name"));
        var varietyid=getQueryVariable("varietyId")
        var check=0;

        $.ajax({
            //几个参数需要注意一下
            type: "post",//方法类型
            dataType: "json",//预期服务器返回的数据类型
            async : false,
            url: "/YqLook/varietyById" ,//url
            data: {
                id:varietyid,
                name:name
            },
            success: function (result) {
                console.log(result);//打印服务端返回的数据(调试用)
                if(result.code==1){
                    // window.location.href = '/404.html';
                    //   swal("哎呀出错了，要不你稍后再试试？", "", "error");
                    // check= "1";

                    // getVarietyDetails();
                    // findcCommentByVarietyId(1);
                    check=1;
                    // console.log(check);


                }
                else{
                    swal("哎呀出错了", "", "error");
                    check=-1;


                }
            },
            error : function(e) {
                // alert("异常！");
                // window.location.href = '/404.html';
                // window.location.href = '/404.html';
                swal("哎呀出错了，要不你稍后再试试？", "", "error");
                check=-1;

                // check= "-1";
            }

        });
        return check;
    }

    function showTV() //跳转到播放地址
    {
        window.location.href = showtvurl;
    }


    //节目详情
    function getVarietyDetails() {
        // console.log($("#id").val())
        // var token=getCookie("token");

        // var userid=getCookie("userid");
        var name=decodeURIComponent(getQueryVariable("name"));
        var userid=getCookie("userid")
        var i=checkVarietyId();
        // console.log(decodeURIComponent(name))
        if(i==1) {
            $.ajax({
                //几个参数需要注意一下
                type: "post",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: "/YqLook/varietyDetails",//url
                data: {
                    name: name,
                    userid: userid
                },
                success: function (result) {
                    console.log(result);//打印服务端返回的数据(调试用)
                    if (result.data == null) {
                        window.location.href = '/404.html';
                    }
                    if (result.code == 1 && result.data != null) {
                        $("#name").text(result.data.variety.name);
                        // $("#fromtv").text(result.data.fromtv);
                        for (var i in result.data.variety.fromtv) {
                            // $("#fromtvdiv").append('<a href="#" id=fromtv"' + i + '">' + result.data.variety.fromtv[i] + '</a>&nbsp;');
                            $("#fromtvdiv").append(result.data.variety.fromtv[i] + '&nbsp;');
                        }
                        for (var i in result.data.variety.type) {
                            $("#type").append("<a href=/VarietyType.html?area=全部地区&type="+ result.data.variety.type[i]+"> "+ result.data.variety.type[i] + "</a>&nbsp;");
                            // $("#type").append('<a href=/VarietyType.html?area=全部地区&type='+ result.data.variety.type[i]+ 'id="atype' + i + '">' + result.data.variety.type[i] + '</a>&nbsp;');
                            // /VarietyType.html?area=全部地区&type='+ result.data.variety.type[i]+ '
                            // $("#atype"+i).text(result.data.type[i]);
                            // console.log(decodeURIComponent(result.data.type[i]))
                        }
                        $("#content-pane").text(result.data.variety.content);
                        $("#updatetime").text(result.data.variety.update);
                        // $("#area").text(result.data.area);
                        for (var i in result.data.variety.area) {
                            // $("#areadiv").append('<a href="#" id="aarea' + i + '">' + result.data.variety.area[i] + '</a>&nbsp;');
                            $("#areadiv").append( result.data.variety.area[i] +'&nbsp;');
                        }
                        $("#img1").attr("src", result.data.variety.picurl);
                        showtvurl = result.data.variety.btn

                        var n = parseInt(result.data.ratings)
                        document.getElementById("showb").style.width = (30 * n) + "px"
                        //
                        // $("#img1").attr("src","images/星光大道 2018.jpg");
                        // $("#img1").attr("src","C:/Users/Dell/Desktop/pic/youku/星光大道 2018.jpg");
                        if (result.data.variety.type.length>1)
                        {

                            var num=RandomNum(0,result.data.variety.type.length);
                            console.log(num);
                            console.log(result.data.variety.name);
                            VarietySame(result.data.variety.type[num],result.data.variety.name);
                        }
                        else{
                            console.log(result.data.variety.name);
                            VarietySame(result.data.variety.type[0],result.data.variety.name);
                        }



                    }
                    if (result.code == -1) {
                        swal("系统异常啦，赶快联系管理员叭!", "", "error");
                        // window.location.href = '/404.html';

                    }
                },
                error: function (e) {
                    swal("系统异常啦，赶快联系管理员叭!", "", "error");
                    // window.location.href = '/404.html';
                }
            });
        }
        else
        {
            swal("当前 页面有错误哦，您从新进入试试!", "", "error");
            setTimeout("window.location.href = '/index.html' ", 2000 );
        }

    }
    /* 单机li进行页面跳转 */
    $(function(){

        $("ul li").click(function(){
            /*当前标签下的a标签*/
            var obj = $(this).children("a");
            /*获取第一个a标签，进行跳转*/
            window.location.href=$(obj[0]).attr("href");
        });
    })




    /* 评星 */
    function insertRatings(num) {
        // console.log("1");
        var userid = getCookie("userid");
        var varietyId = getQueryVariable("varietyId");
        var num1 = parseInt(num);
        var i = checkVarietyId();

        if (i == 1) {

            if (userid != null || userid != "") {
                $.ajax({
                    //几个参数需要注意一下
                    type: "post",//方法类型
                    dataType: "json",//预期服务器返回的数据类型
                    url: "/Ratings/insertOrUpdateRatings",//url
                    data: {
                        varietyId: varietyId,
                        userid: userid,
                        ratings: num1
                    },
                    success: function (result) {
                        console.log(result);//打印服务端返回的数据(调试用)
                        if (result.code == 1) {
                            swal("评星成功!", "", "success");
                        }
                        if (result.code == -1) {
                            window.location.href = '/404.html';
                            // swal("哎呀出错了，要不你稍后再试试？", "", "error");

                        }
                    },
                    error: function (e) {
                        // alert("异常！");
                        swal("要评论需要先登录哦!", "", "error");
                    }
                });


            }
            else {
                window.location.href = '/login.html';//未登录返回登录界面
            }
        }
        else{
            swal("当前 页面有错误哦，您从新进入试试!", "", "error");
            setTimeout("window.location.href = '/index.html' ", 2000 );
            // setTimeout("", 2000 );
        }
    }

    // window.refresh();




</script>
<script type="text/javascript">
    // 初始化数据
    // var arr = [
    //     {userid:1,img:"./images/img.jpg",name:"rty",content:"123",commentDate:"",replyBody:[]},
    //     {userid:2,img:"./images/img.jpg",name:"rty",content:"123",commentDate:"",replyBody:[]},
    //     {userid:2,img:"./images/img.jpg",name:"rty",content:"123",commentDate:"",replyBody:[]},
    //     {userid:2,img:"./images/img.jpg",name:"rty",content:"123",commentDate:"",replyBody:[]}
    // ]

    // var arr=[]
    // var arr =""

    var pageNum=0;// 当前页面
    var totalNum=0;// 总页码
    var totalList=0// 记录总数量

    //新增评论
    function insertComment(){
        var userid = getCookie("userid");
        var name=getCookie("name");
        var varietyId = getQueryVariable("varietyId");
        var comment=$("#content").val();
        var i =checkVarietyId();
        // checkVarietyId(varietyId);


        if(i==1) {
            if (userid != null || userid!="") {

                if (comment.trim()==""||comment==null)
                {
                    swal("请输入评论内容");
                }
                else {
                    $.ajax({
                        //几个参数需要注意一下
                        type: "post",//方法类型
                        dataType: "json",//预期服务器返回的数据类型
                        url: "/Comments/insertComment",//url
                        data: {
                            varietyId: varietyId,
                            userid: userid,
                            comment: comment,
                            name: name
                        },
                        success: function (result) {
                            console.log(result);//打印服务端返回的数据(调试用)
                            if (result.code == 1) {
                                swal("评论成功!", "", "success");
                                $("#content").val("");
                                // $("#content").val("");
                                //         var headpic=getCookie("headpic")
                                //         var obj = new Object();
                                //         obj.picurl=headpic;
                                //         obj.name=getCookie("name");
                                //         obj.comment=$("#content").val();
                                //         obj.replyBody="";
                                //         obj.userid=getCookie("userid");
                                //         $(".comment-list").addCommentList({data:[],add:obj});
                                        // insertComment()



                                // findcCommentByVarietyId(1);

                            }
                            if (result.code == -1) {
                                window.location.href = '/404.html';
                                // swal("哎呀出错了，要不你稍后再试试？", "", "error");

                            }
                        },
                        error: function (e) {
                            // alert("异常！");
                            swal("请登录！", "", "error");
                            setTimeout("exitTologin()", 2000);
                        }
                    });
                }
            }
            else {
                swal("要评论需要先登录哦!", "", "error");
            }
        }
        else {
            swal("当前 页面有错误哦，您从新进入试试!", "", "error");
            setTimeout("window.location.href = '/index.html' ", 2000 );
        }

    }

    $("#sousuo").click(function(){
        $(this).attr("href","/searchVariety.html?word="+$("#vue").val());
    })


    //显示评论
    function findcCommentByVarietyId(pageSize) {
        var varietyId = getQueryVariable("varietyId");
        var i=checkVarietyId();
        pageNum=pageSize;
        if(i==1) {

            $.ajax({
                //几个参数需要注意一下
                type: "post",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: "/Comments/getCommentListByVarietyId",//url
                data: {
                    varietyId: varietyId,
                    pageNum: pageSize, //默认第一页
                    pageSize: 10
                },
                success: function (result) {
                    console.log(result);//打印服务端返回的数据(调试用)
                    if (result.code == 1) {
                        if (result.data.list.length==0) {
                            $("#page").css("display", "none");
                        }

                        totalList=result.data.total;
                        totalNum=Math.ceil(totalList/10);
                        console.log(totalNum)
                        $("#page").paging({
                            pageNum: pageNum, // 当前页面
                            totalNum: totalNum, // 总页码
                            totalList: totalList, // 记录总数量
                            flag:0
                            // callback: function (num) { //回调函数
                            //     console.log(num);
                            // }
                        });
                        // if(totalList%10==0)
                        // {
                        //     totalNum=totalList/10;
                        //     console.log(Math.ceil(totalList/10))
                        // }
                        // if(totalList%10!=0)
                        // {
                        //     totalNum=Math.ceil(totalList/10);
                        //     console.log(totalNum)
                        // }

                        var arr = result.data.list;
                        $(".comment-list").addCommentList({data: arr, add: ""});
                        // console.log(arr)
                    }
                    else {
                        // window.location.href = '/404.html';
                        swal("哎呀出错了，要不你稍后再试试？", "", "error");

                    }
                },
                error: function (e) {
                    // alert("异常！");
                    // swal("要评论需要先登录哦!", "", "error");
                    swal("登录信息过期了，需要重新登录哦", "", "error");
                    exitlogin();

                }
            });
        }
        else
        {
            swal("当前 页面有错误哦，您从新进入试试!", "", "error");
            setTimeout("window.location.href = '/index.html' ", 2000 );
        }



    }


    //
    $(function(){
        $("#comment").click(function(){

            if($("#content").val().length>100)
            {
                swal("评论信息长度不能大于100");
            }
            else if($("#content").val().length==0||$("#content").val()==null||$("#content").val().trim()==""){
                swal("请输入评论内容");
            }
            else{
                var headpic=getCookie("headpic")
                var obj = new Object();
                obj.picurl=headpic;
                obj.name=getCookie("name");
                obj.comment=$("#content").val();

                obj.replyBody="";
                obj.userid=getCookie("userid");
                $(".comment-list").addCommentList({data:[],add:obj});
                insertComment()
            }

        });
    }) //评论


    // $("#page").paging({
    //     pageNum: pageNum, // 当前页面
    //     totalNum: totalNum, // 总页码
    //     totalList: totalList, // 记录总数量
    //     flag:0,
    //     callback: function (num) { //回调函数
    //         console.log(num);
    //     }
    // });




    $(document).ready(function () {
        var token=getCookie("token");
        if (token!=null){
            $("#login-btn").css("display","none");
            $("#register-btn").css("display","none");

        }
        if(token==null||token=="")
        {
            $("#userinform").css("display","none");
            $("#exit").css("display","none");
        }
        getVarietyDetails()
        findcCommentByVarietyId(1);
        // var i=checkVarietyId();
        // console.log(i);

    })

    //跳转到个人中心
    function getUserInform() {
        // console.log($("#id").val())
        var token=getCookie("token");
        var userid=getCookie("userid");
        if (token==null||token=="")
        {
            window.location.href = '/login.html';
            // swal("Good!", "弹出了一个操作成功的提示框", "success");
        }
        else {

            $.ajax({
                //几个参数需要注意一下
                type: "post",//方法类型
                dataType: "json",//预期服务器返回的数据类型
                url: "/API/index/userInform" ,//url
                data: {
                    userid:userid
                },
                success: function (result) {
                    console.log(result);//打印服务端返回的数据(调试用)
                    if (result.code == 1) {
                        // swal("登录成功!", "", "success");


                        window.location.href = '/userinform.html?name='+result.data.name+'&sex='+result.data.sex+'&birthday='+result.data.birthday;
                    }
                    if(result.code==-1){
                        swal("系统异常!", "", "error");

                    }},
                error : function(e) {
                    swal("身份验证失败请重新登录", "", "error");
                    exitTologin();
                }
            });
        }



    }
</script>






</body>
</html>


